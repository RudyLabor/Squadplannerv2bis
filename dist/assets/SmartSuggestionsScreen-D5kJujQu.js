import{r as c,z as S,j as e,m as C,T as k,H as $,B as q}from"./index-D_HhqbxM.js";import{B as I}from"./button-LWl2mh07.js";import{A as T}from"./arrow-left-CFku1NrH.js";import{S as v}from"./sparkles-CBkY3RwN.js";function J({onNavigate:m,showToast:y,data:t,useMockData:x=!1}){const[u,h]=c.useState([]),[b,f]=c.useState(!0);c.useEffect(()=>{j()},[t==null?void 0:t.squadId]);const j=async()=>{if(!(!(t!=null&&t.squadId)&&!x)){f(!0);try{if(x)await new Promise(r=>setTimeout(r,1e3)),h([{id:"1",day:2,dayName:"Mardi",hour:21,time:"21:00",score:98,confidence:95,sessionsCount:12,title:"Mardi Tryhard",description:"Créneau historique le plus performant"},{id:"2",day:4,dayName:"Jeudi",hour:20,time:"20:00",score:85,confidence:82,sessionsCount:8,title:"Jeudi Soirée",description:"Bon taux de réponse avant le week-end"},{id:"3",day:0,dayName:"Dimanche",hour:14,time:"14:00",score:75,confidence:70,sessionsCount:5,title:"Dimanche Après-midi",description:"Idéal pour les sessions longues"}]);else{const{sessions:r}=await S.getSessions(t==null?void 0:t.squadId),i={};r.forEach(s=>{var g;if(s.status!=="confirmed")return;const a=s.slots.find(l=>l.id===s.selectedSlotId);if(!a)return;const o=new Date(`${a.date}T${a.time}:00`),n=o.getDay(),p=o.getHours(),d=`${n}-${p}`;i[d]||(i[d]={count:0,confirmed:0,day:n,hour:p}),i[d].count++,(((g=a.responses)==null?void 0:g.filter(l=>l.response==="yes").length)||0)>=(s.playersNeeded||5)*.5&&i[d].confirmed++});const w=Object.values(i).map(s=>{const a=s.confirmed/s.count*100,o=Math.min(s.count*10,100),n=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];return{id:`${s.day}-${s.hour}`,day:s.day,dayName:n[s.day],hour:s.hour,time:`${String(s.hour).padStart(2,"0")}:00`,score:a,confidence:o,sessionsCount:s.count,title:`${n[s.day]} ${s.hour}h`,description:`${s.confirmed} sessions réussies sur ${s.count} essais`}}).filter(s=>s.sessionsCount>=1).sort((s,a)=>a.score*a.confidence-s.score*s.confidence).slice(0,3);h(w)}}catch(r){console.error("Load suggestions error:",r),y(r.message||"Erreur d'analyse","error")}finally{f(!1)}}},N=r=>{m("create-session",{squadId:t==null?void 0:t.squadId,prefilledDay:r.day,prefilledTime:r.time})};return e.jsx("div",{className:"min-h-screen pb-24 pt-safe bg-[var(--bg-base)]",children:e.jsxs("div",{className:"px-4 py-8 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>m("home"),className:"w-10 h-10 rounded-xl bg-white border-[0.5px] border-[var(--border-medium)] hover:border-[var(--border-strong)] flex items-center justify-center shadow-sm transition-all duration-200",children:e.jsx(T,{className:"w-5 h-5 text-[var(--fg-secondary)]",strokeWidth:2})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-[var(--fg-primary)] tracking-tight",children:"Suggestions Intelligentes"}),e.jsx("p",{className:"text-sm text-[var(--fg-tertiary)] mt-1",children:"Basées sur l'historique de votre squad"})]})]}),b?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-[var(--fg-tertiary)]",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-[var(--primary-500)] border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Analyse en cours..."})]})}):u.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-8 border-[0.5px] border-[var(--border-subtle)] shadow-sm text-center",children:[e.jsx(v,{className:"w-12 h-12 text-[var(--fg-tertiary)] mx-auto mb-4",strokeWidth:1.5}),e.jsx("p",{className:"text-sm text-[var(--fg-secondary)] mb-2",children:"Pas encore de suggestions"}),e.jsx("p",{className:"text-xs text-[var(--fg-tertiary)]",children:"Jouez plus de sessions pour débloquer les suggestions intelligentes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-br from-[var(--primary-50)] to-[var(--secondary-50)] rounded-2xl p-5 mb-6 border-[0.5px] border-[var(--primary-200)]",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-[var(--primary-500)] flex-shrink-0 mt-0.5",strokeWidth:2}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-[var(--fg-primary)] mb-1",children:"✨ Top 3 Créneaux Recommandés"}),e.jsx("p",{className:"text-xs text-[var(--fg-tertiary)]",children:"Ces créneaux ont historiquement le meilleur taux de participation dans votre squad"})]})]})}),e.jsx("div",{className:"space-y-4",children:u.map((r,i)=>e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"bg-white rounded-2xl p-5 border-[0.5px] border-[var(--border-medium)] shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg font-bold ${i===0?"bg-gradient-to-br from-[var(--warning-500)] to-[var(--warning-600)] text-white":i===1?"bg-gradient-to-br from-[var(--fg-tertiary)] to-[var(--fg-secondary)] text-white":"bg-[var(--primary-50)] text-[var(--primary-500)]"}`,children:["#",i+1]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[var(--fg-primary)] tracking-tight",children:r.title}),e.jsx("p",{className:"text-xs text-[var(--fg-tertiary)] mt-0.5",children:r.description})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-[var(--bg-subtle)] rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[var(--success-500)] mb-1",children:[e.jsx(k,{className:"w-4 h-4",strokeWidth:2}),e.jsx("span",{className:"text-xs font-semibold",children:"Confiance"})]}),e.jsxs("div",{className:"text-2xl font-bold text-[var(--fg-primary)]",children:[r.confidence,"%"]})]}),e.jsxs("div",{className:"bg-[var(--bg-subtle)] rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[var(--primary-500)] mb-1",children:[e.jsx($,{className:"w-4 h-4",strokeWidth:2}),e.jsx("span",{className:"text-xs font-semibold",children:"Sessions"})]}),e.jsx("div",{className:"text-2xl font-bold text-[var(--fg-primary)]",children:r.sessionsCount})]})]}),e.jsxs(I,{variant:"default",onClick:()=>N(r),className:"w-full h-11 text-sm font-semibold bg-gradient-to-br from-[var(--primary-500)] to-[var(--primary-600)] hover:from-[var(--primary-600)] hover:to-[var(--primary-700)] text-white rounded-xl shadow-lg shadow-[var(--primary-500)]/20 transition-all duration-200",children:[e.jsx(q,{className:"w-4 h-4",strokeWidth:2}),"Créer cette session"]})]},r.id))})]})]})})}export{J as SmartSuggestionsScreen,J as default};
