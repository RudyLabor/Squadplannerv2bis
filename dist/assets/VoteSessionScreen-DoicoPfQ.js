import{j as e,G as A,r as y,m as b,B as I,C as N,D as S,X as V,E as M}from"./index-D_HhqbxM.js";import{S as q,c as P,B as W}from"./button-LWl2mh07.js";import{C as B}from"./clock-CJ_fTx8V.js";import{C as $}from"./circle-help-VaNueDAt.js";import{u as E,C as z}from"./useSoundEffects-DrNcZ70x.js";import{u as L}from"./useHaptic-BhqY_yQP.js";import{I as T}from"./ImageWithFallback-C-S-nwbk.js";import{A as D}from"./arrow-left-CFku1NrH.js";import{C as F}from"./circle-check-big-B3sZbBy8.js";const O=P("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function w({className:a,variant:o,asChild:m=!1,...i}){const d=m?q:"span";return e.jsx(d,{"data-slot":"badge",className:A(O({variant:o}),a),...i})}const Q={primary:"bg-[var(--primary-500)]",success:"bg-[var(--success-500)]",warning:"bg-[var(--warning-500)]",danger:"bg-[var(--danger-500)]",teal:"bg-[var(--teal-500)]"},R={primary:"bg-gradient-to-r from-[var(--primary-400)] to-[var(--primary-600)]",success:"bg-gradient-to-r from-[var(--success-400)] to-[var(--success-600)]",warning:"bg-gradient-to-r from-[var(--warning-400)] to-[var(--warning-600)]",danger:"bg-gradient-to-r from-[var(--danger-400)] to-[var(--danger-600)]",teal:"bg-gradient-to-r from-[var(--teal-400)] to-[var(--teal-600)]"};function H({value:a,max:o=100,height:m="8px",className:i="",showLabel:d=!1,color:x="primary",variant:l="default"}){const[n,s]=y.useState(0);y.useEffect(()=>{const p=setTimeout(()=>{s(a)},100);return()=>clearTimeout(p)},[a]);const u=Math.min(n/o*100,100);return e.jsxs("div",{className:`w-full ${i}`,children:[e.jsxs("div",{className:"relative w-full rounded-full bg-[var(--bg-tertiary)] overflow-hidden",style:{height:m},children:[e.jsx(b.div,{className:`absolute inset-y-0 left-0 rounded-full ${l==="gradient"?R[x]:Q[x]}`,initial:{width:0},animate:{width:`${u}%`},transition:{duration:.8,ease:[.16,1,.3,1]}}),e.jsx(b.div,{className:"absolute inset-y-0 w-full bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},animate:{x:"100%"},transition:{duration:1.5,delay:.2,ease:"easeInOut"}})]}),d&&e.jsxs(b.div,{className:"mt-2 text-sm font-semibold text-[var(--fg-secondary)] text-right",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[Math.round(u),"%"]})]})}function J({slot:a,currentUserResponse:o,totalMembers:m,playersNeeded:i,onVote:d,isWinning:x=!1,isConfirmed:l=!1}){const n=a.responses.filter(t=>t.response==="yes").length,s=a.responses.filter(t=>t.response==="no").length,u=a.responses.filter(t=>t.response==="maybe").length,p=a.responses.length,h=p/m*100,j=n>=i,f=h>=80,g=new Date(a.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"});return e.jsxs(b.div,{layout:!0,className:`bg-white rounded-2xl p-5 border-[0.5px] transition-all duration-200 ${l?"border-[var(--success-500)] ring-2 ring-[var(--success-500)]/20 shadow-lg":x?"border-[var(--primary-500)] ring-2 ring-[var(--primary-500)]/20 shadow-md":"border-[var(--border-subtle)] shadow-sm hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{className:"w-4 h-4 text-[var(--fg-tertiary)]",strokeWidth:1.5}),e.jsx("div",{className:"text-sm font-semibold text-[var(--fg-primary)] capitalize",children:g})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-[var(--fg-tertiary)]",strokeWidth:1.5}),e.jsxs("div",{className:"text-sm text-[var(--fg-secondary)] font-medium",children:[a.time," ‚Ä¢ ",a.duration]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[l&&e.jsxs(w,{variant:"success",className:"text-xs",children:[e.jsx(N,{className:"w-3 h-3",strokeWidth:2}),"Confirm√©"]}),x&&!l&&e.jsx(w,{variant:"primary",className:"text-xs",children:"üèÜ En t√™te"}),f&&!l&&e.jsx(w,{variant:"info",className:"text-xs",children:"Quorum atteint"})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1 bg-[var(--success-50)] rounded-xl px-3 py-2 border-[0.5px] border-[var(--success-200)]",children:[e.jsx("div",{className:"text-lg font-bold text-[var(--success-600)]",children:n}),e.jsxs("div",{className:"text-xs text-[var(--success-700)] font-medium",children:["Pr√©sent",n>1?"s":""]})]}),e.jsxs("div",{className:"flex-1 bg-[var(--danger-50)] rounded-xl px-3 py-2 border-[0.5px] border-[var(--danger-200)]",children:[e.jsx("div",{className:"text-lg font-bold text-[var(--danger-600)]",children:s}),e.jsxs("div",{className:"text-xs text-[var(--danger-700)] font-medium",children:["Absent",s>1?"s":""]})]}),e.jsxs("div",{className:"flex-1 bg-[var(--warning-50)] rounded-xl px-3 py-2 border-[0.5px] border-[var(--warning-200)]",children:[e.jsx("div",{className:"text-lg font-bold text-[var(--warning-600)]",children:u}),e.jsx("div",{className:"text-xs text-[var(--warning-700)] font-medium",children:"Peut-√™tre"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-xs text-[var(--fg-tertiary)] font-medium",children:"Progression des votes"}),e.jsxs("div",{className:"text-xs font-semibold text-[var(--fg-secondary)]",children:[p,"/",m," (",Math.round(h),"%)"]})]}),e.jsx(H,{value:h,max:100,height:"6px",color:f?"success":"primary",variant:"gradient"})]}),j?e.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-[var(--success-50)] rounded-xl px-3 py-2 border-[0.5px] border-[var(--success-200)]",children:[e.jsx(N,{className:"w-4 h-4 text-[var(--success-600)]",strokeWidth:2}),e.jsxs("div",{className:"text-sm text-[var(--success-700)] font-semibold",children:[n,"/",i," joueurs confirm√©s"]})]}):e.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-[var(--warning-50)] rounded-xl px-3 py-2 border-[0.5px] border-[var(--warning-200)]",children:[e.jsx(S,{className:"w-4 h-4 text-[var(--warning-600)]",strokeWidth:1.5}),e.jsxs("div",{className:"text-sm text-[var(--warning-700)] font-medium",children:[n,"/",i," joueurs (il manque ",i-n,")"]})]}),!l&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>d(a.id,"yes"),className:`flex-1 h-11 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center justify-center gap-2 ${o==="yes"?"bg-[var(--success-500)] text-white shadow-md":"bg-[var(--success-50)] text-[var(--success-700)] border-[0.5px] border-[var(--success-200)] hover:bg-[var(--success-100)]"}`,children:[e.jsx(N,{className:"w-4 h-4",strokeWidth:2}),"Je viens"]}),e.jsxs("button",{onClick:()=>d(a.id,"maybe"),className:`flex-1 h-11 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center justify-center gap-2 ${o==="maybe"?"bg-[var(--warning-500)] text-white shadow-md":"bg-[var(--warning-50)] text-[var(--warning-700)] border-[0.5px] border-[var(--warning-200)] hover:bg-[var(--warning-100)]"}`,children:[e.jsx($,{className:"w-4 h-4",strokeWidth:2}),"Peut-√™tre"]}),e.jsxs("button",{onClick:()=>d(a.id,"no"),className:`flex-1 h-11 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center justify-center gap-2 ${o==="no"?"bg-[var(--danger-500)] text-white shadow-md":"bg-[var(--danger-50)] text-[var(--danger-700)] border-[0.5px] border-[var(--danger-200)] hover:bg-[var(--danger-100)]"}`,children:[e.jsx(V,{className:"w-4 h-4",strokeWidth:2}),"Absent"]})]})]})}function ae({onNavigate:a,showToast:o}){const[m,i]=y.useState({}),[d,x]=y.useState(!1),{selection:l}=L(),{play:n}=E(),s={title:"Session Valorant Class√©",game:"Valorant",gameImage:"https://images.unsplash.com/photo-1538481199705-c710c4e965fc?w=400",proposedBy:"Alex",proposedByAvatar:"https://i.pravatar.cc/150?img=1",playersNeeded:5,slots:[{id:"slot-1",date:"2026-01-25",time:"20:00",duration:"2h",responses:[{playerId:"1",playerName:"Alex",playerAvatar:"https://i.pravatar.cc/150?img=1",response:"yes"},{playerId:"2",playerName:"Marie",playerAvatar:"https://i.pravatar.cc/150?img=5",response:"yes"},{playerId:"3",playerName:"Lucas",playerAvatar:"https://i.pravatar.cc/150?img=12",response:"yes"},{playerId:"4",playerName:"Sophie",playerAvatar:"https://i.pravatar.cc/150?img=25",response:"maybe"}]},{id:"slot-2",date:"2026-01-26",time:"19:00",duration:"2h",responses:[{playerId:"1",playerName:"Alex",playerAvatar:"https://i.pravatar.cc/150?img=1",response:"yes"},{playerId:"2",playerName:"Marie",playerAvatar:"https://i.pravatar.cc/150?img=5",response:"no"},{playerId:"5",playerName:"Tom",playerAvatar:"https://i.pravatar.cc/150?img=33",response:"yes"}]},{id:"slot-3",date:"2026-01-27",time:"21:00",duration:"2h",responses:[{playerId:"3",playerName:"Lucas",playerAvatar:"https://i.pravatar.cc/150?img=12",response:"yes"},{playerId:"4",playerName:"Sophie",playerAvatar:"https://i.pravatar.cc/150?img=25",response:"yes"},{playerId:"5",playerName:"Tom",playerAvatar:"https://i.pravatar.cc/150?img=33",response:"maybe"}]}],squadId:"squad-1",squadName:"Les Fragsters",totalMembers:6},u=(r,v)=>{i(k=>({...k,[r]:v})),l(),n("click"),o(`Vote enregistr√© : ${v==="yes"?"‚úÖ Pr√©sent":v==="no"?"‚ùå Absent":"ü§∑ Peut-√™tre"}`,"success")},p=()=>{x(!0),setTimeout(()=>{a("squad-detail",{id:s.squadId})},2500)},h=s.slots.map(r=>({...r,yesCount:r.responses.filter(v=>v.response==="yes").length})),j=Math.max(...h.map(r=>r.yesCount)),f=h.filter(r=>r.yesCount===j&&r.yesCount>0),c=f.length===1?f[0]:null,g=new Set(s.slots.flatMap(r=>r.responses.map(v=>v.playerId))).size,t=g/s.totalMembers>=.8,C=c&&c.yesCount>=s.playersNeeded&&t;return e.jsx("div",{className:"min-h-screen pb-24 pt-safe",children:e.jsxs("div",{className:"px-4 py-8 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("button",{onClick:()=>a("squad-detail",{id:s.squadId}),className:"w-12 h-12 rounded-2xl bg-white border-[0.5px] border-[var(--border-medium)] flex items-center justify-center hover:border-[var(--border-strong)] shadow-sm transition-all",children:e.jsx(D,{className:"w-5 h-5 text-[var(--fg-primary)]",strokeWidth:2})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[var(--fg-primary)] tracking-tight",children:"Vote sur la session"}),e.jsx("div",{className:"text-sm text-[var(--fg-tertiary)] font-medium mt-0.5",children:s.squadName})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden border-[0.5px] border-[var(--border-subtle)] shadow-md mb-8",children:[e.jsxs("div",{className:"relative h-32",children:[e.jsx(T,{src:s.gameImage,alt:s.game,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),e.jsxs("div",{className:"absolute bottom-4 left-4",children:[e.jsx("div",{className:"text-xs text-white/70 font-medium mb-1",children:s.game}),e.jsx("div",{className:"text-xl font-bold text-white",children:s.title})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("img",{src:s.proposedByAvatar,alt:s.proposedBy,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[var(--fg-tertiary)] font-medium",children:"Propos√© par"}),e.jsx("div",{className:"text-sm font-semibold text-[var(--fg-primary)]",children:s.proposedBy})]})]}),e.jsxs("div",{className:"bg-[var(--primary-50)] rounded-xl p-3 border-[0.5px] border-[var(--primary-200)]",children:[e.jsx("div",{className:"text-xs text-[var(--primary-700)] font-medium mb-1",children:"Objectif"}),e.jsxs("div",{className:"text-sm font-semibold text-[var(--primary-900)]",children:[s.playersNeeded," joueurs minimum requis"]})]})]})]}),e.jsxs("div",{className:"bg-[var(--secondary-50)] rounded-2xl p-5 mb-6 border-[0.5px] border-[var(--secondary-200)]",children:[e.jsx("h3",{className:"text-sm font-semibold text-[var(--fg-primary)] mb-2",children:"üìä Comment voter ?"}),e.jsxs("ul",{className:"text-sm text-[var(--fg-tertiary)] space-y-1",children:[e.jsxs("li",{children:["‚Ä¢ Votez sur ",e.jsx("span",{className:"font-semibold",children:"chaque cr√©neau"})," propos√©"]}),e.jsxs("li",{children:["‚Ä¢ Quand ",e.jsx("span",{className:"font-semibold",children:"80% ont vot√©"}),", le cr√©ateur peut confirmer"]}),e.jsxs("li",{children:["‚Ä¢ Le cr√©neau avec le ",e.jsx("span",{className:"font-semibold",children:'plus de "Je viens"'})," gagne"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-semibold text-[var(--fg-primary)]",children:"Participation globale"}),e.jsxs("div",{className:"text-sm font-semibold text-[var(--fg-secondary)]",children:[g,"/",s.totalMembers," membres ont vot√©"]})]}),e.jsx("div",{className:"h-2 bg-[var(--bg-subtle)] rounded-full overflow-hidden",children:e.jsx(b.div,{initial:{width:0},animate:{width:`${g/s.totalMembers*100}%`},transition:{duration:.5},className:`h-full rounded-full ${t?"bg-[var(--success-500)]":"bg-[var(--primary-500)]"}`})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-[var(--fg-primary)] mb-4",children:"Cr√©neaux propos√©s"}),e.jsx("div",{className:"space-y-4",children:s.slots.map((r,v)=>e.jsx(J,{slot:r,currentUserResponse:m[r.id],totalMembers:s.totalMembers,playersNeeded:s.playersNeeded,onVote:u,isWinning:(c==null?void 0:c.id)===r.id,isConfirmed:!1},r.id))})]}),C&&e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-[var(--success-50)] to-[var(--primary-50)] rounded-2xl p-6 mb-8 border-[0.5px] border-[var(--success-200)] shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[var(--success-500)] flex items-center justify-center flex-shrink-0",children:e.jsx(M,{className:"w-6 h-6 text-white",strokeWidth:2})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[var(--fg-primary)] mb-1",children:"Pr√™t √† confirmer !"}),e.jsx("p",{className:"text-sm text-[var(--fg-tertiary)]",children:"Le quorum est atteint et vous avez assez de joueurs confirm√©s. Vous pouvez valider la session."})]})]}),e.jsxs(W,{variant:"primary",onClick:p,className:"w-full h-12 bg-[var(--success-500)] hover:bg-[var(--success-600)] text-white rounded-xl shadow-md font-semibold",children:[e.jsx(F,{className:"w-5 h-5",strokeWidth:2}),"Confirmer ce cr√©neau"]})]}),!C&&e.jsxs("div",{className:"text-center text-sm text-[var(--fg-tertiary)] font-medium",children:[!t&&e.jsxs("p",{children:["En attente de plus de votes (",Math.round(g/s.totalMembers*100),"% / 80%)"]}),t&&!c&&e.jsx("p",{children:"Aucun cr√©neau ne remporte la majorit√© pour le moment"}),t&&c&&c.yesCount<s.playersNeeded&&e.jsx("p",{children:"Pas assez de joueurs confirm√©s sur le cr√©neau gagnant"})]}),d&&e.jsx(z,{className:"absolute top-0 left-0 right-0 bottom-0",onEnd:()=>x(!1)})]})})}export{ae as VoteSessionScreen,ae as default};
